(()=>{function p(t,n=[],e={}){let o="http://www.w3.org/2000/svg",r=document.createElementNS(o,t);n.forEach(s=>{r.classList.add(s)});for(let[s,i]of Object.entries(e))r.setAttribute(s,i);return r}function y(t,n){let[e,o]=n,r=`M${e[0]},${e[1]} L${o[0]},${o[1]}`,u=p("path",["end"],{d:r,fill:"none",stroke:"black","stroke-width":1});t.appendChild(u)}function x(t,n){let e=`M${n[0][0]},${n[0][1]}`+n.slice(1).map(i=>`L${i[0]},${i[1]}`).join(" "),s=p("path",["level"],{d:e,fill:"none",stroke:"black","stroke-width":1});t.appendChild(s)}function f({intercept:t,slope:n}){return function(e){return n*e+t}}function v(t,n){let e=t.slope,o=n.slope;return e===o?S():Number.isFinite(e)&&Number.isFinite(o)?M(t,n):!Number.isFinite(e)&&o===0||!Number.isFinite(o)&&e===0?b(t,n):B(t,n)}function S(){return null}function M(t,n){let e=t.slope,o=t.intercept,r=n.slope,s=n.intercept,i=1/(e-r);return[i*(s-o),i*(e*s-o*r)]}function B(t,n){let e=t.slope,o=t.intercept,r=n.slope,s=n.intercept;if(!Number.isFinite(e)){let a=f({slope:r,intercept:s})(t.x);return[(a-s)/r,a]}let u=f({slope:e,intercept:o})(n.x);return[(u-o)/e,u]}function b(t,n){let e=t.slope,o=t.intercept,r=n.slope,s=n.intercept;return!Number.isFinite(r)&&e===0?[n.x,o]:!Number.isFinite(e)&&r===0?[t.x,s]:null}function w(t,n){let[e,o]=t,[r,s]=n;return e===r?s<o?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY:(o*r-s*e)/(r-e)}function E(t,n){let[e,o]=t,[r,s]=n;return e===r?s<o?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY:o===s?0:(s-o)/(r-e)}function h(t,n){let e=E(t,n),o=w(t,n);return Number.isFinite(e)?{intercept:o,slope:e}:{intercept:o,slope:e,x:t[0]}}function $(t,n,e,o){let r=j(e,o,n),s=`M${r[0][0]},${r[0][1]}`+r.slice(1).map(a=>`L${a[0]},${a[1]}`).join(" "),l=p("path",["light"],{d:s,fill:"none",stroke:"orange","stroke-width":1}),c=l.getTotalLength();l.style.strokeDasharray=`${c} ${c}`,l.style.strokeDashoffset=c,l.getBoundingClientRect(),l.style.transition="stroke-dashoffset 1s linear",t.appendChild(l),setTimeout(()=>l.style.strokeDashoffset="0",500)}function j(t,n,e){let o=[t],r=I(t),s=I(t.map((c,a)=>c+n[a])),i=[];for(let c=0;c<e.length-1;c++){let a=I(e[c]),d=I(e[c+1]),T=h(a,d);i.push({start:[...e[c]],end:[...e[c+1]],length:k(e[c],e[c+1]),...T})}let u=h(r,s),l=i.map((c,a)=>{let d=v({intercept:c.intercept,slope:c.slope},u);return{...c,crosspoint:d,distance:k(d,r),index:a,within:{x:r[0]>=c.start[0]&&r[0]<=c.end[0],y:r[1]>=c.start[1]&&r[1]<=c.end[1]}}}).filter(c=>c.within.x||c.within.y);return l.length===0?O():(o.push(A(l.reduce((c,a)=>c.distance<a.distance?c:a).crosspoint)),o)}function I(t){let[n,e]=t;return[n,100-e]}function A(t){let[n,e]=t;return[n,100-e]}function k(t,n){if(!t||!n)return null;let[e,o]=t,[r,s]=n;return Math.sqrt(Math.pow(Math.abs(r-e),2)+Math.pow(Math.abs(s-o),2))}function O(){alert("You lost")}function L(t,n){let e=`M${n[0]},${n[1]} l3,5 h-6Z`,s=p("path",["start"],{d:e,fill:"orange",stroke:"orange","stroke-width":1});t.appendChild(s)}var m=[{name:"Level I",start:[50,91],end:[[45,11],[55,11]],shape:[[49,90],[40,90],[40,10],[60,10],[60,90],[51,90]]},{name:"Level O",start:[45,91],end:[[52,89],[58,89]],shape:[[44,90],[40,90],[35,88],[30,85],[25,80],[20,70],[15,60],[15,40],[20,30],[25,20],[30,15],[35,12],[40,10],[60,10],[65,12],[70,15],[75,20],[80,30],[85,40],[85,60],[80,70],[75,80],[70,85],[60,90],[51,90],[51,70],[60,70],[70,60],[70,40],[60,30],[40,30],[30,40],[30,60],[40,70],[49,70],[49,90],[46,90]]},{name:"Level M",start:[15,91],end:[[82,89],[88,89]],shape:[[14,90],[10,90],[10,20],[20,10],[30,10],[45,70],[55,70],[70,10],[80,10],[90,20],[90,90],[80,90],[80,24],[60,90],[40,90],[20,24],[20,90],[16,90]]},{name:"Level R",start:[15,91],end:[[82,89],[88,89]],shape:[[14,90],[10,90],[30,40],[25,38],[20,35],[15,30],[15,20],[20,15],[25,12],[30,10],[49,10],[50,12],[51,10],[70,10],[75,12],[80,15],[85,20],[85,30],[80,35],[75,38],[70,40],[90,90],[80,90],[60,40],[60,90],[51,90],[51,30],[70,30],[75,25],[70,20],[30,20],[25,25],[30,30],[49,30],[49,90],[40,90],[40,40],[20,90],[16,90]]}];var g=0;R(m.map(t=>t.name));V();C(m[g].name);function R(t){let n=document.getElementById("levels");t.forEach(e=>{let o=document.createElement("li");o.textContent=e,n.appendChild(o)})}function V(){let t=document.getElementById("angle"),n=document.getElementById("form"),e=document.getElementById("levels");t.addEventListener("change",o=>W(o)),n.addEventListener("submit",o=>z(o)),e.addEventListener("click",o=>Y(o))}function W(t){let n=document.querySelector(".start");if(n===null)return;let e=t.target,o=parseInt(e.value,10),{start:r}=m[g],[s,i]=r;n.setAttribute("transform",`rotate(${o}, ${s}, ${i})`),N()}function Y(t){let{currentTarget:n,target:e}=t;e.nodeName.toLowerCase()==="li"&&(g=Array.from(n.children).findIndex(o=>o===e),C(e.textContent))}function z(t){t.preventDefault();let n=document.getElementById("root");N();let{shape:e,start:o}=m[g];$(n,e,o,D()),U(),F()}function C(t){let n=document.getElementById("root"),e=m.find(o=>o.name===t);_(),x(n,e.shape),L(n,e.start),y(n,e.end),F()}function G(){let t=document.getElementById("angle");t.value=0}function Z(){let t=document.getElementById("attempt");t.value=0}function _(){G(),Z(),J(),X(),H(),N()}function J(){let t=document.querySelector(".level");t&&t.remove()}function X(){let t=document.querySelector(".start");t&&t.remove()}function H(){let t=document.querySelector(".end");t&&t.remove()}function N(){let t=document.querySelector(".light");t&&t.remove()}function D(){let t=document.getElementById("angle"),n=K(parseInt(t.value,10)-90);return P({r:1,degree:n})}function K(t){return t*Math.PI/180}function P(t){let{r:n,degree:e}=t,o=parseFloat((Math.cos(e)/n).toFixed(2)),r=parseFloat((Math.sin(e)/n).toFixed(2));return[o,r]}function F(){let t=document.getElementById("root"),n=document.querySelector('link[rel="icon"]'),o=new XMLSerializer().serializeToString(t).replace(/ id="\w+"/g,"").replace(/ style=".*"/g,"").replace(/ class="\w+"/g,"");n.href="data:image/svg+xml;utf8,"+o}function U(){let t=document.getElementById("share-me"),n=document.getElementById("attempt"),e=parseInt(n.value,10)!==1?"":"s",o=`${n.value} attempt${e}`,r=g+1,s=encodeURIComponent(['I played "I Really Move On".',`I completed level ${r} after ${o}!`,"What is your highscore?",""].join(`
`)),{hostname:i,pathname:u,protocol:l}=location,a=`https://twitter.com/intent/tweet?url=${encodeURIComponent(`${l}//${i}${u}`)}&hashtags=gamedevjs&via=AndreJaenisch&text=${s}`;t.href=a}})();
//# sourceMappingURL=app.js.map
